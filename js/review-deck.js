(()=>{"use strict";var e={430:(e,t,a)=>{a.d(t,{$:()=>i});class s{value;next;constructor(e){this.value=e}}class n{#e;#t;#a;constructor(){this.clear()}enqueue(e){const t=new s(e);this.#e?(this.#t.next=t,this.#t=t):(this.#e=t,this.#t=t),this.#a++}dequeue(){const e=this.#e;if(e)return this.#e=this.#e.next,this.#a--,e.value}clear(){this.#e=void 0,this.#t=void 0,this.#a=0}get size(){return this.#a}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}}const r={0:144e5,1:144e5,2:288e5,3:864e5,4:1728e5,5:6048e5,6:12096e5,7:2592e6,8:5184e6};function l(e){for(var t=1;t<arguments.length;t++)if(void 0===arguments[t])throw new TypeError("Failed to execute '"+e+"'. Missing argument(s).")}class i{constructor(e=null,t=null,a=null){if(this.name=e,this.description=t,this.cards=[],null!=a)for(let e=0;e<a.length;++e){let t=a[e],s=t.getElementsByClassName("question")[0].value,n=t.getElementsByClassName("answer")[0].value.trim();""!==s&&""!==n&&this.cards.push({q:s,ans:n,nextReview:0,stage:0})}}set name(e){this._name=""===e?"Unnamed Deck":e}get name(){return this._name}review(){return new c(this.cards)}static unserialise(e){l("unserialise",e);let t=new i;return Object.assign(t,JSON.parse(e)),t}serialise(){return this.reviews=[],JSON.stringify(this)}updateToLocalStorage(e){l("updateToLocalStorage",e);let t=window.localStorage.getItem("user-decks"),a=t?JSON.parse(t):[];console.assert(e>=0&&e<a.length,"Deck index out of range"),a[e]=this.serialise(),window.localStorage.setItem("user-decks",JSON.stringify(a))}static getFromLocalStorage(e){l("getFromLocalStorage",e);let t=localStorage.getItem("user-decks"),a=t?JSON.parse(t):[];return console.assert(e>=0&&e<a.length,"Deck index out of range"),i.unserialise(a[e])}static addToLocalStorage(e){l("addToLocalStorage",e);let t=window.localStorage.getItem("user-decks");t=t?JSON.parse(t):[],t.push(e.serialise()),window.localStorage.setItem("user-decks",JSON.stringify(t))}static removeFromLocalStorage(e){l("removeFromLocalStorage",e);let t=window.localStorage.getItem("user-decks");t=t?JSON.parse(t):[],t.splice(e,1),window.localStorage.setItem("user-decks",JSON.stringify(t))}getHTMLForm(){return new o(this)}}class o{constructor(e=null){this.deck=e,this.htmlTag=document.createElement("div"),this.htmlTag.innerHTML='<div class="row">\n\t\t\t<div class="column-left">\n\t\t\t\t<label for="deck-name">Deck Name</label>\n\t\t\t\t<input type="text" id="deck-name" class="deck-name" maxlength=100>\n\t\t\t\t<label for="deck-description">Description</label>\n\t\t\t\t<textarea id="deck-description" class="deck-description" maxlength=1500></textarea>\n\t\t\t</div>\n\t\t\t\x3c!-- <div class="column-right">\n\t\t\t\t<label for="deck-icon-btn">Icon</label><br>\n\t\t\t\t<button id="deck-icon-btn" onclick="document.getElementById(\'deck-icon\').click();">\n\t\t\t\t\t[Not Implemented] Choose an image\n\t\t\t\t</button>\n\t\t\t\t<input id="deck-icon" type="file" accept="image/*" style="display: none;" />\n\t\t\t</div> --\x3e\n\t\t</div>\n\t\t<div class="center">\n\t\t\t<div class="flashcard" data-id="1">\n\t\t\t\t<label class="name">Card 1</label>\n\t\t\t\t<button class="fa fa-close close-btn" tabindex="-1"></button>\n\t\t\t\t<textarea rows="4" class="question" placeholder="Question"></textarea>\n\t\t\t\t<textarea rows="4" class="answer" placeholder="Answer"></textarea>\n\t\t\t</div>\n\t\t</div>',this._updateLastCard()}_requireDeckRef(){console.assert(null!=this.deck,"Error, DeckHTMLForm was not given a Deck class to reference.")}fillFormData(){this._requireDeckRef();let e=this.htmlTag.getElementsByClassName("deck-name")[0],t=this.htmlTag.getElementsByClassName("deck-description")[0];e.value=this.deck.name,t.value=this.deck.description,this._fillCards();let a=this.htmlTag.getElementsByClassName("flashcard");for(let e=0;e<this.deck.cards.length;++e){let t=this.deck.cards[e];a[e].getElementsByClassName("question")[0].value=t.q,a[e].getElementsByClassName("answer")[0].value=t.ans}}enableAutoCardInsertion(){this._updateLastCard();let e=this.htmlTag.getElementsByClassName("flashcard");for(let t of e)this._addCardListeners(t)}generateDeck(){let e=this.htmlTag.getElementsByClassName("deck-name")[0].value,t=this.htmlTag.getElementsByClassName("deck-description")[0].value,a=this.htmlTag.getElementsByClassName("flashcard");return new i(e,t,a)}updateDeck(){this._requireDeckRef();let e=this.htmlTag.getElementsByClassName("deck-name")[0].value,t=this.htmlTag.getElementsByClassName("deck-description")[0].value,a=this.htmlTag.getElementsByClassName("flashcard");this.deck.name=e,this.deckDescription=t,this.cards=a}_fillCards(){this._requireDeckRef();let e=this.htmlTag.getElementsByClassName("flashcard");for(;e.length<this.deck.cards.length;)this._addCard()}_addCardListeners(e){let t=e.getElementsByClassName("close-btn")[0],a=e.getElementsByClassName("question")[0],s=e.getElementsByClassName("answer")[0],n=this;t.addEventListener("click",(function(e){n._deleteCardCallback(e)})),s.addEventListener("input",(function(e){n._addCardCallback(e)})),a.addEventListener("input",(function(e){n._addCardCallback(e)}))}_updateLastCard(){let e=this.htmlTag.getElementsByClassName("flashcard");this.lastCard=e[e.length-1]}_addCardCallback(e){e.path[1]===this.lastCard&&this._addCard()}_addCard(){let e=this.lastCard.cloneNode(!0),t=Number(this.lastCard.getAttribute("data-id"))+1;e.setAttribute("data-id",t),e.getElementsByTagName("label")[0].innerHTML="Card "+t;for(let t of e.getElementsByTagName("textarea"))t.value="";this._addCardListeners(e),this.lastCard.insertAdjacentElement("afterend",e),this.lastCard=e}_deleteCardCallback(e){let t=e.path[1],a=this.htmlTag.getElementsByClassName("flashcard");if(1!=a.length)if(t===this.lastCard)this.lastCard=t.previousElementSibling,t.remove();else{let e=Number(t.getAttribute("data-id"))-1;for(t.remove();e<a.length;++e){let t=a[e];t.setAttribute("data-id",e+1),t.getElementsByTagName("label")[0].innerHTML="Card "+(e+1)}}}}class c{constructor(e){l("ReviewSession constructor",e),this.reviewQueue=new n,this.summary={correct:[],wrong:[]},this.cards=e,this.current=null;let t=Date.now();for(let e=0;e<this.cards.length;++e){let a=this.cards[e];t>a.nextReview&&a.stage<=8&&this.reviewQueue.enqueue({card:this.cards[e],numWrong:0})}this.reviewQueue.size>0&&(this.current=this.reviewQueue.dequeue())}nextCard(){return null===this.current?null:this.current.card}logAns(e){if(l("logAns",e),this.done)return;let t=Date.now(),a=this.current.card,s=!1;if(e.trim()===a.ans)if(s=!0,this.current.numWrong>0){let e=a.stage>=5?2:1,t=a.stage-Math.ceil(this.current.numWrong/2*e);a.stage=t>0?t:1,this.summary.wrong.push(a)}else a.stage+=1,this.summary.correct.push(a);else this.reviewQueue.enqueue({card:a,numWrong:this.current.numWrong+1});return a.nextReview=function(e){let t=36e5;return Math.floor(e/t)*t}(t+r[a.stage]),0===this.reviewQueue.size?this.current=null:this.current=this.reviewQueue.dequeue(),s}}},444:(e,t,a)=>{let s=!1;function n(){if(!1===s){document.getElementsByClassName("topnav")[0].style.width="118px";let e=document.getElementById("hamburger");e.classList.remove("fa-bars"),e.classList.add("fa-close"),s=!0}else{document.getElementsByClassName("topnav")[0].style.width="0";let e=document.getElementById("hamburger");e.classList.add("fa-bars"),e.classList.remove("fa-close"),s=!1}}window.addEventListener("load",(function(){document.getElementById("hamburger").addEventListener("click",n)}))}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,a),r.exports}a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{a(444);var e=a(430);let t=null,s=null,n=null,r=null,l=!1,i=null,o=null,c=!1;function d(){c||(t.updateToLocalStorage(s),c=!0)}function u(e){13===(e.which||e.keyCode)&&h()}function h(){if(l)return i.removeAttribute("disabled"),void function(){if(r=n.nextCard(),null===r)return function(){let e=n.summary,a=document.getElementById("main-content"),s=function(e){if(0===e.length)return"";let t="<ul style='margin: 0;padding-left:1.5em;'>";for(let a of e)t+="<li>"+a.q+"</li>";return t+="</ul>",t},r=s(e.correct),l=s(e.wrong),i=e.correct.length+e.wrong.length;""==r&&(r="<p>No correct cards? One day...</p>"),""==l&&(l="<p>Yay! No incorrect cards.</p>"),a.classList.remove("center"),a.innerHTML="Finished studying <b>"+t.name+"</b>.<p><b>"+Math.round(e.correct.length/i*100)+"%</b> correct.</p><br><b>Correct cards</b>"+r+"<br><b>Wrong cards</b>"+l+"<br><a href='index.html'>Back to home?</a>",console.log(t)}(),void d();o.innerHTML=r.q,i.focus(),l=!1,i.style.backgroundColor="",i.value=""}();let e=i.value.trim();if(""===e)return i.focus(),void(i.value="");let a=n.logAns(e);i.style.backgroundColor=a?"#88CC00":"#FF0033",i.setAttribute("disabled",""),l=!0}window.onload=function(){document.body.onbeforeunload=function(){d()},document.body.addEventListener("keypress",u);let a=new URLSearchParams(window.location.search);s=a.get("deck-index"),function(a){t=e.$.getFromLocalStorage(a);let s=document.getElementById("main-content");s.classList.add("center"),0!==t.cards.length?(n=t.review(),r=n.nextCard(),null!==r?(s.innerHTML+="<p id='question'>"+r.q+"</p><div id='input-field'><input id='answer-input' placeholder='Answer' autocapitalize='none' autocomplete='off' autocorrect='off' spellcheck='false' autofocus><button id='next-card-btn' class='fa fa-chevron-right'></button></div>",o=document.getElementById("question"),i=document.getElementById("answer-input"),document.getElementById("next-card-btn").addEventListener("click",h)):s.innerHTML+="<p>No cards ready for review.</p><a href='index.html'>Back to home page?</a>"):s.innerHTML+="<p>Interesting... there are no cards in this deck.</p><a href='index.html'>Back to home page?</a>"}(s)}})()})();